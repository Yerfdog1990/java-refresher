
---

# Leverage HTTP Verbs and Semantics in REST API Operations

## Defining REST API Operations with Spring

### Learning Objectives

By the end of this lesson, students should be able to:

* Map CRUD operations to appropriate HTTP verbs
* Explain why specific HTTP methods are chosen
* Implement REST endpoints in Spring that respect HTTP semantics
* Understand idempotency and its importance in REST APIs

---

## 1. Why HTTP Verbs Matter in REST

REST APIs rely on **HTTP semantics** to clearly express intent.

Instead of inventing custom operations like:

```
/createCampaign
/updateCampaign
/deleteCampaign
```

REST APIs leverage:

* **Standard HTTP verbs**
* **Meaningful URLs**
* **Consistent status codes**

This leads to APIs that are:

* Intuitive
* Predictable
* Easy to consume
* Protocol-compliant

---

## 2. Mapping CRUD to HTTP Verbs

| CRUD Operation   | HTTP Verb | Typical URL     |
| ---------------- | --------- | --------------- |
| Create           | POST      | /campaigns      |
| Read (list)      | GET       | /campaigns      |
| Read (single)    | GET       | /campaigns/{id} |
| Update (full)    | PUT       | /campaigns/{id} |
| Update (partial) | PATCH     | /campaigns/{id} |
| Delete           | DELETE    | /campaigns/{id} |

---

## 3. Retrieve Resources ‚Äì GET

Retrieving data is the most common REST operation.

### 3.1 List All Resources

```java
@GetMapping
public List<CampaignDto> listCampaigns() {
    // ‚Ä¶
}
```

**Semantics used:**

* HTTP Verb: **GET**
* URL: `/campaigns`
* Response Status: **200 OK**

‚úî GET is:

* Safe
* Read-only
* Idempotent

---

### 3.2 Retrieve a Single Resource

```java
@GetMapping("/{id}")
public CampaignDto findOne(@PathVariable Long id) {
    // ‚Ä¶
}
```

**Semantics used:**

* HTTP Verb: **GET**
* URL: `/campaigns/{id}`
* Path Variable: `id`
* Response Status: **200 OK**

If the resource does not exist:

* **404 Not Found** should be returned

---

### 3.3 Filtering and Pagination (Conceptual)

List endpoints often support **query parameters**:

```java
@GetMapping
public List<CampaignDto> list(
    @RequestParam int page,
    @RequestParam int size) {
}
```

üìå Important note:

* Pagination is **not a resource**
* It is part of the **representation**

Pagination metadata (next, previous, total pages) often appears in:

* Response headers
* Response body wrapper objects

---

## 4. Create, Update, and Partial Update

### POST, PUT, and PATCH

---

## 4.1 Create Resource ‚Äì POST

```java
@PostMapping
@ResponseStatus(HttpStatus.CREATED)
public CampaignDto create(@RequestBody CampaignDto newCampaign) {
    // ‚Ä¶
}
```

**Semantics used:**

* HTTP Verb: **POST**
* URL: `/campaigns`
* Request Body: `CampaignDto`
* Response Status: **201 Created**

### Why POST?

* Resource identity is generated by the server
* Operation is **not idempotent**
* Multiple identical requests create multiple resources

---

## 4.2 Update Resource (Full Replace) ‚Äì PUT

```java
@PutMapping("/{id}")
public CampaignDto update(
    @PathVariable Long id,
    @RequestBody CampaignDto updatedCampaign) {
    // ‚Ä¶
}
```

**Semantics used:**

* HTTP Verb: **PUT**
* URL: `/campaigns/{id}`
* Path Variable: `id`
* Request Body: full representation
* Response Status: **200 OK**

### Why PUT?

* Targets a **specific resource**
* Replaces the entire representation
* Operation is **idempotent**

---

## 5. Idempotency Explained

**Idempotency** means:

> Repeating the same request has the same effect as executing it once.

### Comparison

| Method | Idempotent   | Reason                          |
| ------ |------------- |---------------------------------|
| POST   | ‚ùå           | Creates new resource every time |
| PUT    | ‚úÖ           | Replaces resource state         |
| DELETE | ‚úÖ           | Resource remains deleted        |
| GET    | ‚úÖ           | No state change                 |

üìå Idempotency is about **server state**, not response content.

---

## 6. Partial Update ‚Äì PATCH

PUT requires a **complete representation**.

For partial updates:

* PATCH is the correct HTTP verb

```java
@PatchMapping("/{id}")
public CampaignDto partialUpdate(
    @PathVariable Long id,
    @RequestBody Map<String, Object> fields) {
    // ‚Ä¶
}
```

**PATCH semantics:**

* Partial modification
* Not guaranteed to be idempotent
* Requires careful design

‚ö† PATCH is powerful but complex, and often deferred in early projects.

---

## 7. Delete Resource ‚Äì DELETE

```java
@DeleteMapping("/{id}")
@ResponseStatus(HttpStatus.NO_CONTENT)
public void delete(@PathVariable Long id) {
    // ‚Ä¶
}
```

**Semantics used:**

* HTTP Verb: **DELETE**
* URL: `/campaigns/{id}`
* Path Variable: `id`
* Response Status: **204 No Content**

### Why 204?

* Action succeeded
* No response body needed

---

### Alternative DELETE Responses

| Status        | When to Use              |
| ------------- | ------------------------ |
| 200 OK        | Return deletion details  |
| 202 Accepted  | Deletion is asynchronous |
| 404 Not Found | Resource doesn‚Äôt exist   |

---

## 8. Is DELETE Idempotent?

Yes ‚úÖ

Even if:

* First request ‚Üí 204 No Content
* Second request ‚Üí 404 Not Found

The **effect on the server** remains the same:

> The resource is gone

---

## 9. Domain Constraints and DELETE

Not all resources should be deletable.

Common alternatives:

* **Soft delete**
* Status flags (`ACTIVE`, `ARCHIVED`)
* Visibility rules

REST allows flexibility ‚Äî semantics must align with **business rules**.

---

## 10. Summary: REST Operations and Semantics

| Operation      | Verb   | URL             | Status |
| -------------- | ------ | --------------- | ------ |
| List           | GET    | /campaigns      | 200    |
| Get one        | GET    | /campaigns/{id} | 200    |
| Create         | POST   | /campaigns      | 201    |
| Update         | PUT    | /campaigns/{id} | 200    |
| Partial update | PATCH  | /campaigns/{id} | 200    |
| Delete         | DELETE | /campaigns/{id} | 204    |

---

## 11. Key Takeaways

* REST relies on **HTTP semantics**
* URLs identify resources, verbs define actions
* POST ‚â† PUT (creation vs replacement)
* Idempotency improves reliability
* Status codes communicate outcomes clearly
* Spring annotations map REST concepts cleanly

---

