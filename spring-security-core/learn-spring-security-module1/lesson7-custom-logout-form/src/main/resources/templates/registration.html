<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Register Student</title>
    <link rel="stylesheet" th:href="@{/css/styles.css(v=${#dates.createNow().time})}" href="/css/styles.css" />
</head>
<body>
<div class="container">
    <div style="text-align: right; margin-top: 10px;">
        <form th:action="@{/doLogout}" method="post" style="display: inline-block;">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
            <button type="submit" class="btn danger">Logout</button>
        </form>
    </div>
    <h1 th:text="${student.id} != null ? 'Edit Student' : 'Register New Student'"></h1>

    <div th:if="${warning}" class="alert alert-warning" th:text="${warning}"></div>

    <form th:action="${student.id} != null ? @{/users/{id}(id=${student.id})} : @{/users}"
          th:object="${student}"
          method="post">

        <div th:if="${#fields.hasErrors('*')}">
            <div class="alert alert-danger">
                Please fix the form errors below.
            </div>
        </div>

        <div class="form-group">
            <label for="username">Username</label>
            <input id="username" type="text" th:field="*{username}" placeholder="Enter username" />
            <div class="field-error" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></div>
        </div>

        <div class="form-group">
            <label for="email">Email</label>
            <input id="email" type="email" th:field="*{email}" placeholder="Enter email" />
            <div class="field-error" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></div>
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input id="password" type="password" th:field="*{password}" placeholder="Enter password" />
            <div class="field-error" th:if="${#fields.hasErrors('password')}" th:errors="*{password}"></div>
        </div>

        <div class="form-group">
            <label for="role">Role</label>
            <input id="role" type="text" th:field="*{role}" placeholder="Enter role (e.g., ROLE_STUDENT or STUDENT)" />
            <div class="field-error" th:if="${#fields.hasErrors('role')}" th:errors="*{role}"></div>
        </div>

        <div class="actions">
            <button type="submit" class="btn primary" th:text="${student.id} != null ? 'Update' : 'Create'"></button>
            <a class="btn" th:href="@{/home}">Cancel</a>
            <a class="btn" th:href="@{/users}">View registered students</a>
        </div>
        <div th:if="${param.logout}" class="alert alert-danger">You have been logged out.</div>
    </form>
</div>
</body>
</html>
